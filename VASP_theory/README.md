# VASPに使用されている理論
本ドキュメントでは、VASPを使うにあたり、どのような理論が使われているかをまとめていく。  
参考文献は主に[VASPwiki](https://www.vasp.at/wiki/index.php/The_VASP_Manual)から。また、[解説スライド](https://www.slideshare.net/dc1394/ss-26378208)も参考にした。
<div style="text-align: right;">文責：内藤</div>

## 目次    
- [0. 必要になりそうな前提知識](#0-必要になりそうな前提知識)   
- [1. 密度汎関数法](#1-密度汎関数法)  
- [2. Smearing](#2-smearing)  
- [3. SCF計算](#3-scf-計算)  
- [4. 擬ポテンシャル法](#4-擬ポテンシャル法)  
- [5. 局所密度近似法](#5-局所密度近似法)  

*クリックで各セクションへ移動可能である*

## 0. 必要になりそうな前提知識
　この後の話を理解するのに必要そうな式や用語をまとめておく。
### 0.1. Schrödinger方程式
　1926年にErwin R.J.A. Schrödinger が発表？した式である。単一粒子かつ定常状態の場合は、  

$$
\hat{H}\psi (\vec{r}) = E\psi (\vec{r})
$$
$$
\hat{H} = -\frac{\hbar^2}{2m} \nabla^2 + V(\vec{r})
$$  

量子力学A・Bで学習済みではあるが、簡単に復習する。例として、水素原子を考える。なお、原子系は[Hartree原子単位系](#03-hartree原子単位系)を使用する。  

$$
-\frac{1}{2} \nabla^2 \psi(\vec{r}) - \frac{1}{r}\psi(\vec{r}) = E\psi(\vec{r}) 
$$
$$
( r = \sqrt{x^2+y^2+z^2} )
$$  

第一項は __電子の運動エネルギーポテンシャル__ 、第二項は __Ｃoulombポテンシャル__ を表す項である。この方程式は、大変ではあるものの解析的に解くことができる。  
　では、実際に様々な原子の第一原理計算を行う際、どのようにSchrödinger方程式を記述し、解くのか？その際に重要になってくるのが、[Born-Oppenhimer近似](#04-born-oppenhimer近似)である。この近似を用いて、ヘリウム原子のSchrödinger方程式を考えてみる。  
　まず、方程式は、電子が２つ存在するので  

$$
[-\frac{1}{2} \nabla^2_1 - -\frac{1}{2} \nabla^2_2 -\frac{2}{r_1} - \frac{2}{r_2} + \frac{1}{|\vec{r_1}-\vec{r_2}|}] \psi(\vec{r_1}, \vec{r_2}) = E \psi(\vec{r_1}, \vec{r_2})
$$  

となる。第一項と第二項は運動エネルギー、第三項と第四項はCoulombポテンシャルエネルギー、第五項は２つの電子間のCoulombポテンシャルエネルギーである。なお、電子のスピンは考慮していない。
　ヘリウムの場合でも解けなくはないが、一般的に、N電子系を考えたとき、3N+スピンの次元の偏微分方程式を解く必要が出てくるため、__やばい__。炭素Cでさえ、N=12なので目も当てられない状況になるのは明らかだろう。

### 0.2. Dirac方程式
　1928年にPaul A.M. Diracが発表した、Fermi粒子に対する相対論的量子力学の基礎方程式で、原子番号が大きい原子に用いられる。定常状態では、  

$$
\hat{H}\psi (\vec{r}) = E\psi (\vec{r})
$$
$$
\hat{H} = c\vec{\alpha} \cdot {\hat{p}} + \beta mc^2 + V(\vec{r})
$$  

見てわかる通り、４成分の方程式のため、実際に解く際は近似を用いて2成分などにして解く。

### 0.3. Hartree原子単位系
前述の[Schrödinger方程式](#01-schrödinger方程式)を簡単にするために用いられる特殊な単位系である。
|単位の名称|Hartree原子単位系|SI単位系|
|:--:|:--:|:--:|
|長さ|Bohr半径 $a_0$ [ $a_0$ ]| $5.29 \times 10^{-11}$  [ $m$ ] |
|質量|電子の質量 $m_e$ [ $m_e$ ]| $9.11 \times 10^{-31}$  [ $kg$ ]|
|電荷|電気素量e [e]| $1.60 \times 10^{-19}$ [ $C$ ]|
|エネルギー|Hartree [Hartree]| $4.36 \times 10^{-18}$  [ $J$ ] = $27.2 [eV]$|

また、Dirac定数$\hbar$とCoulombポテンシャルの比例定数$\frac{1}{4\pi\epsilon_0}$を __１__ とする。

### 0.4. Born-Oppenheimer近似
&emsp;この近似は、 __電子と原子核は重さが大きく異なるため、運動を別々にしているとみなす近似__ である。一般的には、「電子の方が速く動くから」とされる。  
　電子と原子核が同時に動くと考えるとき、古典的な観点から両者の運動量$p$は等しいので、電子と原子核の質量比（水素なら電子：原子核＝1:1837）の観点から、電子の方が速く動くと言える。しかし、この議論は古典的であり、量子論における運動量演算子には質量が考慮されていないため、速度ではなく、エネルギーで比較したほうが厳密であるため、気を付けてほしい。

### 0.5. Hartree-Fock法

## 1. 密度汎関数法
&emsp;VASPで用いられている第一原理計算の計算手法の一つである。その概要について述べる。  
　DFT計算では、電子軌道内を運動する電子を、電子の密度分布で表現する。この電子密度と個々の電子間に働く引力・斥力相互作用を考慮することで、系内に存在する全ての電子間の相互作用を評価できるため、各原子・分子の安定構造を計算することが可能である。（[参考](https://rdreview.jaea.go.jp/review_jp/kaisetsu/723.html#:~:text=DFT%E8%A8%88%E7%AE%97%E3%81%A7%E3%81%AF%E3%80%81%E9%9B%BB%E5%AD%90%E8%BB%8C%E9%81%93,%E3%81%93%E3%81%A8%E3%81%8C%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82)）  
　すなわち、MD計算では、各原子間に働く相互作用を原子間ポテンシャルからエネルギー・力を求めることで軌跡を計算していたが、DFT計算では原子ではなく __電子__ について相互作用を考えていくということである。
　

## 2. Smearing  
&emsp;INCARタグの __ISMEAR__ と __SIGMA__ に関して。  
　まず、電子の占有率（Fermi分布）などからエネルギーバンド計算や電子のSCF計算を行う際、エネルギーを離散的として計算すると、数値的な齟齬が生じてしまう。  
![SMEARING](https://github.com/MDGroup-WatanabeLab/image_for_mdpython/assets/138444525/a3ece222-b23b-444c-a534-fe1c577931b0)   
　そのため、上の図のオレンジ線色のように、エネルギーに幅を持たせ（SIGMA）、エネルギーを連続的であると近似することで、よりリアルに近い値をことができる。この幅を持たせることが「Smearing」である。  
　VASPのINCARファイルでは、ISMEARがSmearingの種類、SIGMAがその幅を指定するパラメータとなっており、[VASPwiki](https://www.vasp.at/wiki/index.php/ISMEAR)によると、推奨値は以下の表のようになっている。

|INCARタグ|金属 / Metal|半導体 / Semicondutor|
|:--:|:--:|:--:|
|ISMEAR|0, -5|0 (推奨), 1|
|SIGMA|0.05<br>[SCF計算](#3-scf-計算)が収束しないなら<br>より大きく設定する|ISMEAR=0なら0.05<br>ISMEAR=1なら0.2|

### 2.1. Gauss Smearing ( ISMEAR = 0 )

### 2.2. Fermi Smearing ( ISMEAR = -1 )

## 3. SCF 計算

### 3.1. The iterative subspace (RMM-DIIS)

### 3.2. blocked Davidson algorithm

## 4. 擬ポテンシャル法

## 5. 局所密度近似法