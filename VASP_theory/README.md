# VASPに使用されている理論
&emsp;本ドキュメントでは、VASPを使うにあたり、どのような理論が使われているかをまとめていく。

## 目次    
- [0. 必要になりそうな前提知識](#0-必要になりそうな前提知識)   
- [1. 密度汎関数法](#1-密度汎関数法)  
- [2. Smearing](#2-smearing)  
- [3. SCF計算](#3-scf-計算)  
- [4. 擬ポテンシャル法](#4-擬ポテンシャル法)  
- [5. 局所密度近似法](#5-局所密度近似法)  

*クリックで各セクションへ移動可能である*

## 0. 必要になりそうな前提知識
　この後の話を理解するのに必要そうな式や用語をまとめておく。
### 0.1. Schrödinger方程式
　1926年にErwin R.J.A. Schrödinger が発表した式である。単一粒子かつ定常状態の場合は、  

$$
\hat{H}\psi (\vec{r}) = E\psi (\vec{r})
$$  

$$
\hat{H} = -\frac{\hbar^2}{2m} \nabla^2 + V(\vec{r})
$$  

量子力学A・Bで学習済みではあるが、簡単に復習する。例として、水素原子を考える。なお、原子系は[Hartree原子単位系](#03-hartree原子単位系)を使用する。  

$$
-\frac{1}{2} \nabla^2 \psi(\vec{r}) - \frac{1}{r}\psi(\vec{r}) = E\psi(\vec{r}) 
$$  

$$
( r = \sqrt{x^2+y^2+z^2} )
$$  

第一項は __電子の運動エネルギーポテンシャル__ 、第二項は __Ｃoulombポテンシャル__ を表す項である。この方程式は、大変ではあるものの解析的に解くことができる。  
　では、実際に様々な原子の第一原理計算を行う際、どのようにSchrödinger方程式を記述し、解くのか？その際に重要になってくるのが、[Born-Oppenhimer近似](#04-born-oppenheimer近似)である。この近似を用いて、ヘリウム原子のSchrödinger方程式を考えてみる。  
　まず、方程式は、電子が２つ存在するので  

$$
[-\frac{1}{2} \nabla^2_1 - -\frac{1}{2} \nabla^2_2 -\frac{2}{r_1} - \frac{2}{r_2} + \frac{1}{|\vec{r_1}-\vec{r_2}|}] \psi(\vec{r_1}, \vec{r_2}) = E \psi(\vec{r_1}, \vec{r_2})
$$  

となる。第一項と第二項は運動エネルギー、第三項と第四項はCoulombポテンシャルエネルギー、第五項は２つの電子間のCoulombポテンシャルエネルギーである。なお、電子のスピンは考慮していない。  
　ヘリウムの場合でも解けなくはないが、一般的に、N電子系を考えたとき、3N+スピンの次元の偏微分方程式を解く必要が出てくるため、__やばい__。炭素Cでさえ、N=12なので目も当てられない状況になるのは明らかだろう。この多体問題を解く方法が、[密度汎関数法](#1-密度汎関数法)である。

### 0.2. Dirac方程式
　1928年にPaul A.M. Diracが発表した、Fermi粒子に対する相対論的量子力学の基礎方程式で、原子番号が大きい原子に用いられる。定常状態では、  

$$
\hat{H}\psi (\vec{r}) = E\psi (\vec{r})
$$  

$$
\hat{H} = c\vec{\alpha} \cdot {\hat{p}} + \beta mc^2 + V(\vec{r})
$$  

見てわかる通り、４成分の方程式のため、実際に解く際は近似を用いて2成分などにして解く。

### 0.3. Hartree原子単位系
前述の[Schrödinger方程式](#01-schrödinger方程式)を簡単にするために用いられる特殊な単位系である。
|単位の名称|Hartree原子単位系|SI単位系|
|:--:|:--:|:--:|
|長さ|Bohr半径 $a_0$ [ $a_0$ ]| $5.29 \times 10^{-11}$  [ $m$ ] |
|質量|電子の質量 $m_e$ [ $m_e$ ]| $9.11 \times 10^{-31}$  [ $kg$ ]|
|電荷|電気素量e [e]| $1.60 \times 10^{-19}$ [ $C$ ]|
|エネルギー|Hartree [Hartree]| $4.36 \times 10^{-18}$  [ $J$ ] = $27.2 [eV]$|

また、Dirac定数 $\hbar$ とCoulombポテンシャルの比例定数 $\frac{1}{4\pi\epsilon_0}$ を __１__ とする。

### 0.4. Born-Oppenheimer近似
&emsp;この近似は、 __電子と原子核は重さが大きく異なるため、運動を別々にしているとみなす近似__ である。一般的には、「電子の方が速く動くから」とされる。  
　電子と原子核が同時に動くと考えるとき、古典的な観点から両者の運動量$p$は等しいので、電子と原子核の質量比（水素なら電子：原子核＝1:1837）の観点から、電子の方が速く動くと言える。しかし、この議論は古典的であり、量子論における運動量演算子には質量が考慮されていないため、速度ではなく、エネルギーで比較したほうが厳密であるため、気を付けてほしい。


### 0.5. Bornの確率解釈
&emsp;Bornの規則とも呼ばれ、量子力学において、物理量の測定をしたとき、ある値が得られる確率がどのように与えられるかを示す法則である。例えば、位置 $x$ を求めるには、  

$$  
X_{mn} = <\psi_m^*|x|\psi_n> = \int \psi_m^* x \psi_n dx
$$  

で与えられ、波動関数によって決定される。そして、波動関数の二乗 $|\psi(x)|^2$ は電子が $x$ という位置に観測される確率密度を表す。したがって、電子が $x \sim x+dx$ の位置に観測される確率が $|\psi(x)|^2dx$ で表されると解釈できる。  
　ということは、量子力学A・Bで学習した通り、全空間では、

$$  
\int|\psi (x)|^2dx=1
$$  

が成り立っている。

### 0.6. Lagrangeの未定乗数法
&emsp;数学の話なので簡潔に。 $g(x, y)=0$ のもとで、 $f(x, y)$ を最大化したいとき、

$$  
L(x, y, \lambda) = f(x, y) - \lambda g(x, y)
$$  

とおくと、 $(\alpha , \beta)$ が極値を与えるならば、 $(\alpha , \beta)$ は、  

$$  
\frac{\partial L}{\partial x}=\frac{\partial L}{\partial y}=\frac{\partial L}{\partial \lambda}=0
$$  

の解である。または、

$$  
\frac{\partial g}{\partial x}=\frac{\partial g}{\partial y}=0
$$  

の解である。

### 0.7. 汎関数
&emsp;これも数学の話なので、簡潔に。まず、普通の関数について考えよう。ある固定の関数 $f(x)$ を導入したとき、 $x$ を引数として、  

$$  
x \longmapsto f(x)
$$  

というように、写像の形式で書ける。一方、汎関数では、固定されるのは関数 $f(x)$ ではなく、引数である $x$ になる。したがって、  

$$  
f \longmapsto f(x)
$$  

汎関数においては、引数 $x$ はパラメータとして解釈される。また、表記も関数とは異なり、値 $I$ が引数として関数 $f(x)$ を持つとき、  

$$  
I=I[f]
$$  

というように、括弧の種類が変わる。後述する汎関数でも[]を使っているのだが、ミスではないのであしからず。  
　汎関数の例としては、次のような $I$ が挙げられる。  

$$  
I = \int_a^b F(x)dx
$$  

$I$ は $x$ の関数ではなく、 $F$ の関数であると解釈できるであろう。

### 0.8. ガウス型関数  
<img width="424" alt="スクリーンショット 2023-08-19 184512" src="https://github.com/MDGroup-WatanabeLab/image_for_mdpython/assets/138444525/e26f09f4-1a43-4c55-9cf4-4dcad67a5f48">  

&emsp;上に示したような形を取る関数であり、その式は、  

$$  
f(x) = e^{-a^2r^2}
$$  

で表される。

### 0.9. 量子数
電子の分類分けに使う数字のようなもの。  
1. 主量子数 $n$  
   電子殻のK殻、L殻、 $\cdots$ に対応して、 $n=1, n=2, \cdots$ となり、その電子が存在する電子殻を表現している。
2. 方位量子数 $l$  
   軌道の形を表し、 $l=0, 1, \cdots$ $,n-1$ である。 $l=0$ のときs軌道、 $l=1$ のときp軌道、$l=2$ のときd軌道、となる。
3. 磁気量子数 $m$  
   軌道の方向を表し、$-l < m < l$ である。
4. スピン量子数 $s$  
   電子の自転の向きを表し、 $s=\pm \frac{1}{2}$ で表される。

## 1. 密度汎関数法
&emsp;[先](#01-schrödinger方程式)に述べたように、VASPで用いられている第一原理計算の計算手法の一つである。その概要について述べる。  
　DFT計算では、電子軌道内を運動する電子を、電子の密度分布で表現する。この電子密度と個々の電子間に働く引力・斥力相互作用を考慮することで、系内に存在する全ての電子間の相互作用を評価できるため、各原子・分子の安定構造を計算することが可能である。（[参考](https://rdreview.jaea.go.jp/review_jp/kaisetsu/723.html#:~:text=DFT%E8%A8%88%E7%AE%97%E3%81%A7%E3%81%AF%E3%80%81%E9%9B%BB%E5%AD%90%E8%BB%8C%E9%81%93,%E3%81%93%E3%81%A8%E3%81%8C%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82)）  
　すなわち、MD計算では、各原子間に働く相互作用を原子間ポテンシャルからエネルギー・力を求めることで軌跡を計算していたが、DFT計算では原子ではなく __電子__ について相互作用を考えていくということである。  

<br/>

&emsp;そもそも、電子の存在確率は、[Bornの確率解釈](#05-bornの確率解釈)より、3次元波動関数 $\psi( r_1, r_2, r_3, \cdot \cdot \cdot , r_N )$ ではなく、その絶対値2乗である電子密度 $|\psi( r_1, r_2, r_3, \cdot \cdot \cdot , r_N )|^2=\rho(\vec{r})$ から計算される。密度汎関数法はこの $\rho(\vec{r})$ を用いて何か求めることは出来ないか？という考えから生まれたとされる。
<br/>
　密度汎関数法には、Hartree-Fock法とKohn-Sham法の二つがあるので、順に紹介していく。なお、計算班が第一原理計算用ソフトウェアとして用いている[VASP](https://www.vasp.at/wiki/index.php/The_VASP_Manual)では、Kohn-Sham法を用いているようである。

### 1.1. Hartree-Fock法
### 1.1.1. Hartree法
&emsp;では、Hartree-Fock法について解説する。まず、前提として、電子の運動を考えるとしたら、ハミルトニアン演算子を設定し、Schrödinger方程式を解けばいい。しかし、ここで、解析力学や量子力学で問題になる、__3体問題__ が発生する。簡単に言うと、3体以上の物体が相互作用する系の運動を解析的に求めることは出来ないということである。 このことは、__ポアンカレの非可積分性の定理__ により示されている。  
　ここで、ハートリーは複数の電子を持つ原子の3体問題を解ける方法を1928年に提案した。それが、__Hartree法__ である。ヘリウム原子のハミルトニアンを考えると、原子核と電子2つの相互作用から、原子核に対する電子の位置ベクトル $\vec{r_1, r_2}$ を用いて、  

$$  
\hat{H} = -\frac{\nabla ^2_1}{2}-\frac{\nabla ^2_2}{2}+V_{ne}(\vec{r_1})+V_{ne}(\vec{r_2})++V_{ee}(\vec{r_1},\vec{r_2})
$$  

と書ける。先の2項は原子核に対する運動エネルギー演算子、次の2項は原子核ー電子核間の静電相互作用（クーロン）ポテンシャルであり、この2つを合わせて、__１電子演算子__ と呼ぶ。最後の項は、2つの電子間の静電相互作用ポテンシャルであり、__２電子演算子__ と呼ぶ。  
　この式では、[Hartree原子単位系](#03-hartree原子単位系)を用いている。したがって、  

$$  
V_{ne}(\vec{r}) = -\frac{2}{r}=-\frac{2}{|\vec{r}|}
$$  

$$  
V_{ee}(\vec{r_{12}}) = \frac{1}{r_{12}}=-\frac{1}{|\vec{r_2}-\vec{r_1}|}
$$  

と書くことができる。何が言いたいかというと、Hartreeはそれぞれの電子が周りの電子の静電ポテンシャルの平均の中を運動すると仮定することで電子の運動を近似したということである。このポテンシャルの平均は有効ポテンシャル $V_{eff}$ と呼ばれ、この近似は __独立電子近似法__ と呼ばれる。これにより、ハミルトニアンは、  

$$  
\hat{H} = \left[-\frac{\vec{\nabla ^2_1}}{2}+V_{ne}(\vec{r_1})+V_{eff}(\vec{r_1})\right]+\left[-\frac{\vec{\nabla ^2_2}}{2}+V_{ne}(\vec{r_2})+V_{ee}(\vec{r_1, r_2})+V_{eff}(\vec{r_2})\right]
$$  

と書き直せる。したがって、まとめると、  

$$  
\hat{H} = \hat{h}(\vec{r_1})+\hat{h}(\vec{r_2})
$$  

当然、電子数がn個なら、この $\hat{h}$ もn個の和になることは想像に容易いだろう。さて、波動関数については、2つの電子の波動関数の積として、  

$$  
\psi(\vec{r_1}, \vec{r_2}) = \phi_1(\vec{r_1}) \phi_2(\vec{r_2})
$$  

と書くことができる。このときのハミルトニアン演算子の期待値 $E$ は、  

$$
E = \frac{\int d^3 \vec{r_1} d^3 \vec{r_2} \psi^\ast(\vec{r_1}, \vec{r_2}) \hat{H} \psi(\vec{r_1}, \vec{r_2})}{\int d^3 \vec{r_1} d^3 \vec{r_2} \psi^\ast(\vec{r_1}, \vec{r_2}) \psi(\vec{r_1}, \vec{r_2})}
$$

また、

$$
E= \frac{ \Sigma_{i=1}^2 \int d^3 \vec{r_i} \phi_i^\ast(\vec{r_i}) \hat{h} \phi(\vec{r_i})}{ \Sigma_{i=1}^2 \int d^3 \vec{r_i} \phi_i^\ast(\vec{r_i}) \phi_i(\vec{r_i})}
$$



軌道の組 { $\phi_i$ } に対する変分法より、この期待値を停留にする1電子波動関数の組 { $\phi_i$ } を求めるSchrödinger方程式は、  

$$  
\hat{h}(\vec{r_i}) \phi(\vec{r_i}) = \epsilon_i \phi(\vec{r_i})
$$  

と書ける。 $\phi(\vec{r_i})$ は軌道、 $\epsilon_i$ は軌道エネルギーと呼ばれる。ハミルトニアン演算子 $\hat{H}$ は$i$番目の電子のハミルトニアン演算子 $\hat{h}(\vec{r_i})$ の和で表されることから、  

$$  
\hat{H} \psi =(\epsilon_1+\epsilon_2)\phi_1\phi_2 = \epsilon \psi
$$ 

となる。すなわち、全固有エネルギーは各電子の運動に対応する軌道エネルギーの和となるということである。これが、__Hartree法__ である。  
　ここで、有効ポテンシャルは次のように表されることがある。  

$$  
V_{eff}(\vec{r_i}) = \sum_j \int d^3\vec{r_j} \frac{|\phi_j(\vec{r_j})|^2}{|\vec{r_i}-\vec{r_j}|} 
$$  

この説明だけ聞くと、人によっては、「なんだ、これだけか？」と思うかもしれない。実際、電子の軌道については最新の理論と比較しても大差ない再現ができた。しかし、このHartree法で導かれたエネルギーは到底使える値では無かった。それは、電子の交換を考慮していないためであった。エネルギーの重要性は言わずもがな、一番大事であるのでこのままではいけない。

### 1.1.2. 分子軌道法
&emsp;ココで一度、電子の運動について考えてみたい。水素分子 $H_2$ を考えると、ハミルトニアン演算子は、  

$$  
\hat{H} = \hat{h}(\vec{r_1})+\hat{h}\vec{r_2}+V_{nn}(R_{AB})
$$  

$R_{AB}$ は2つの原子核間距離を表し、最後の項は原子核間の相互作用を表す。ここで、[Born-Oppenheimer近似](#04-born-oppenheimer近似)より、  

$$  
\hat{H} = \hat{h}(\vec{r_1})+\hat{h}\vec{r_2}
$$  

ちなみに、[前の節](#111-hartree法)に出てきたヘリウム原子と比べると、水素分子は原子核が2つあるので、電子の位置ベクトルもより複雑になる。つまり、より複雑なハミルトニアンになっていることは忘れてはいけない。  
　この問題を解決するのが、__分子軌道__ の概念である。フントが1926年に提唱し、マリケンが1927年に発表した。そして、1932年にレナード・ジョーンズが分子軌道を原子軌道の線形結合で表す、__LCAO-MO 近似__ (Linear Combination of Atomic Orbitals - Molecular Orbital approximation) を経験的推測として発表した。そして、1938年にこの近似を水素分子に適用したのがクールソンであり、これが、__分子軌道法__ の始まりである。  
　では、具体的に式で見ていく。LCAO-MO 近似に基づき、水素分子の分子軌道は、  

$$  
\phi = C_1\chi_1 + C_2\chi_2
$$  

$C$ は分子軌道係数、 $\chi$ は原子軌道を表す。ハミルトニアン演算子の期待値 $E$ は、  

$$
E= \frac{ \Sigma_{i=1}^2 \int d^3 \vec{r_i} \phi_i^\ast(\vec{r_i}) \hat{h} \phi(\vec{r_i})}{ \Sigma_{i=1}^2 \int d^3 \vec{r_i} \phi_i^\ast(\vec{r_i}) \phi_i(\vec{r_i})}
$$

を用いて、

$$  
\epsilon = \frac{C_1^2h_{11} + C_2^2h_{22}+2C_1C_2h_{12}}{C_1^2+C_2^2+2C_1C_2S_{12}}
$$  

となる。ここで、  

$$  
h_{ij} = \int d^3 \vec{r} \chi_i \hat{h} \chi_j <  0
$$  

$$  
S_{12} = \int d^3 \vec{r} \chi_1 \chi_2 > 0
$$  

となっている。 $\epsilon$ は分子軌道の軌道エネルギーであり、このエネルギーを最小にするような係数 $C_1, C_2$ を考えると、  

$$  
\frac{\partial \epsilon}{\partial C_1}=\frac{\partial \epsilon}{\partial C_2} = 0
$$  

を満たしていればよい。したがって、  

$$  
(h_{11}-\epsilon)C_1 + (h_{12}-\epsilon S_{12})C_2 = 0
$$  

$$  
(h_{12}-\epsilon S_{12})C_1 + (h_{22}-\epsilon)C_2 = 0
$$  

自明でない解を持つためには、  

$$  
\begin{vmatrix}
    h_{11}-\epsilon & h_{12}-\epsilon S_{12} \\
    h_{12}-\epsilon S_{12} & h_{22}-\epsilon \\
\end{vmatrix}
 = 0
$$  

が成り立つ。したがって、分子軌道の軌道エネルギーは、  

$$  
\epsilon_\pm = \frac{h_{11}\pm h_{12}}{1\pm S_{12}}\qquad(\epsilon_+ < \epsilon_-)
$$  

また、規格化された分子軌道は、  

$$  
\phi_\pm = \frac{\chi_1 \pm \chi_2}{\sqrt{2\pm2S_{12}}}
$$  

となる。ここで、__Pauliの排他律__ を思い出してほしい。４つの[量子数](#09-量子数)がすべて同じ電子は存在しないとされる。したがって、水素分子の場合、 $\phi_+$ 軌道はスピンが異なる二つの電子に占有される。つまり、水素分子の波動関数は、  

$$  
\Phi = \phi_+(\vec{r_1})\phi_+(\vec{r_2})
$$  

$$  
\Phi = \frac{1}{2+2S_{12}} \left\{ \chi_1(\vec{r_1})+ \chi_2(\vec{r_1}) \right\} \left\{ \chi_1(\vec{r_2})+ \chi_2(\vec{r_2}) \right\}
$$  

と書き表される。したがって、水素分子の全エネルギーは、スピンの向きがエネルギーの大きさに影響を及ぼさないので、  

$$  
E = 2\epsilon_+ = \frac{2\left(h_{11} + h_{12}\right)}{1 + S_{12}}
$$  

今回のような、結合エネルギー＝軌道エネルギーとなるのは、水素分子のような結合が少ない場合である。複雑な結合には、様々な軌道からの寄与を考えなければいけない。つまり、一般には、__結合エネルギーと軌道エネルギーには相関がないためセットで論ずることはできない__ ので、注意が必要となる。  

### 1.1.3. 電子の交換有の波動関数  
&emsp;1926年、HeisenbergとDiracは各々、「Pauliの排他律を自然に満たすには、波動関数が反対称化されていなければならず、行列式で表される必要がある。」と提案した。反対称化によって生まれる新たな相互作用を __交換相互作用__ と呼ぶ。1929年にSlaterがSchrödinger方程式の一般的解法を作り上げ、__交換積分__ も初めて提案された。  
　では、ヘリウムを例に、電子の交換とはどういうものか見ていこう。交換しても変わらないということは、ハミルトニアンは、

$$  
\hat{H}(\vec{r_1}, \vec{r_2})= \hat{H}(\vec{r_2}, \vec{r_1}) = -\frac{\nabla ^2_1}{2}-\frac{\nabla ^2_2}{2}+V_{ne}(\vec{r_1})+V_{ne}(\vec{r_2})++V_{ee}(\vec{r_1},\vec{r_2})
$$ 

となる。ということは、  

$$  
\hat{H}(\vec{r_1}, \vec{r_2}) \Psi(\vec{r_2}, \vec{r_1}) = E\Psi(\vec{r_2}, \vec{r_1})
$$  

2電子を入れ替える交換演算子 $\hat{P}_{12}$ について、  

$$  
\hat{H}(\vec{r_1}, \vec{r_2}) \hat{P} _{12} \Psi(\vec{r_1}, \vec{r_2}) = \hat{P}_{12} \hat{H}(\vec{r_1}, \vec{r_2}) \Psi(\vec{r_1}, \vec{r_2})
$$  

つまり、  

$$  
\left[ \hat{H}, \hat{P}_{12} \right]\Psi = 0
$$  

であるから、可換であるとわかる。さらに、ハミルトニアン演算子と交換演算子が同時固有状態を持つことがわかる。また、2回の交換で元に戻るということは、$\hat{P}_{12}^2 = 1$ であるので、 $\hat{P}_{12}$ の固有値は $\pm 1$ であるとわかる。なので、交換演算子の固有値が $\pm 1$ である波動関数をそれぞれ対称波動関数と反対称波動関数とすると、規格化すると次のように表せる。  

$$  
\Psi^{(S)}(\vec{r_1}, \vec{r_2}) = \frac{1}{\sqrt{2}} \{\Psi(\vec{r_1}, \vec{r_2})+\Psi(\vec{r_2}, \vec{r_1}) \}=\Psi^{(S)}(\vec{r_2}, \vec{r_1})
$$  


$$  
\Psi^{(A)}(\vec{r_1}, \vec{r_2}) = \frac{1}{\sqrt{2}} \left\{\Psi(\vec{r_1}, \vec{r_2})-\Psi(\vec{r_2}, \vec{r_1}) \right\} = -\Psi^{(A)}(\vec{r_2}, \vec{r_1})
$$  

さらに、Hartree波動関数についても考えると、

$$  
\Psi^{(S)}(\vec{r_1}, \vec{r_2}) = \frac{1}{\sqrt{2}} \left\{\phi_1 (\vec{r_1})\phi_2 (\vec{r_2})+\phi_1(\vec{r_2})\phi_2 (\vec{r_1}) \right\}
$$  


$$  
\Psi^{(A)}(\vec{r_1}, \vec{r_2}) = \frac{1}{\sqrt{2}} \left\{\phi_1 (\vec{r_1})\phi_2 (\vec{r_2})-\phi_1(\vec{r_2})\phi_2 (\vec{r_1}) \right\}
$$ 

ここで、気を付けるべきなのは、__Pauliの排他律を満たしているのは、反対称波動関数だけ__ という点である。すなわち、__電子は反対称波動関数を持つ__ ことがわかる。反対称波動関数を行列式で書くと、

$$  
\Psi(\vec{r_1}, \vec{r_2})=\frac{1}{\sqrt{2}}
\begin{vmatrix}
    \phi_1 (\vec{r_1}) & \phi_1(\vec{r_2}) \\
    \phi_2 (\vec{r_1}) & \phi_2 (\vec{r_2}) \\
\end{vmatrix}
$$ 

3個以上電子があるときでもどうように行列式で書ける。一般化すると、

$$  
\Psi(\vec{r_1}, \vec{r_2}, \cdots, \vec{r_N})=\frac{1}{\sqrt{N!}}
\begin{vmatrix}
    \phi_1 (\vec{r_1}) & \phi_1(\vec{r_2}) & \cdots & \phi_1 (\vec{r_N}) \\
    \phi_2 (\vec{r_1}) & \phi_2 (\vec{r_2})& \cdots & \phi_2 (\vec{r_N}) \\
    \vdots & \vdots & \ddots& \vdots \\
    \phi_N (\vec{r_1}) & \phi_N (\vec{r_2})& \cdots & \phi_N (\vec{r_N}) \\
\end{vmatrix}
$$ 

この行列こそが、__スレーター行列式__ である。

### 1.1.4 Hartree-Fock法
&emsp;ようやく、本編に入ることができる。章のタイトルにもなっているHartree-Fock法は1930年にFockが提案した。なお、Slaterも同じ年に同じ提案をしている。

### 1.2. Kohn-Sham法
&emsp;では、次に、Kohn-Sham法について解説する。

## 2. Smearing  
&emsp;電子の占有率（Fermi分布）などからエネルギーバンド計算や電子のSCF計算を行う際、エネルギーを離散的として計算すると、数値的な齟齬が生じてしまう。  
![SMEARING](https://github.com/MDGroup-WatanabeLab/image_for_mdpython/assets/138444525/a3ece222-b23b-444c-a534-fe1c577931b0)   
　そのため、上の図のオレンジ線色のように、エネルギーに幅を持たせ（SIGMA）、エネルギーを連続的であると近似することで、よりリアルに近い値をことができる。この幅を持たせることが「Smearing」である。  
　VASPのINCARファイルでは、ISMEARがSmearingの種類、SIGMAがその幅を指定するパラメータとなっており、[VASPwiki](https://www.vasp.at/wiki/index.php/ISMEAR)によると、推奨値は以下の表のようになっている。

|INCARタグ|金属 / Metal|半導体 / Semicondutor|
|:--:|:--:|:--:|
|ISMEAR|0, -5|0 (推奨), 1|
|SIGMA|0.05<br>[SCF計算](#3-scf-計算)が収束しないなら<br>より大きく設定する|ISMEAR=0なら0.05<br>ISMEAR=1なら0.2|

### 2.1. Gauss Smearing ( ISMEAR = 0 )

### 2.2. Fermi Smearing ( ISMEAR = -1 )

## 3. SCF 計算

### 3.1. The iterative subspace (RMM-DIIS)

### 3.2. blocked Davidson algorithm

## 4. 擬ポテンシャル法

## 5. 局所密度近似法